var As=Object.defineProperty;var Is=(a,b,y)=>b in a?As(a,b,{enumerable:!0,configurable:!0,writable:!0,value:y}):a[b]=y;var h=(a,b,y)=>(Is(a,typeof b!="symbol"?b+"":b,y),y);this.telegramApps=this.telegramApps||{};this.telegramApps.sdk=function(a){"use strict";function b(s,e){let t;const n=()=>{t!==void 0&&e&&e(t),t=void 0};return[()=>t===void 0?t=s(n):t,n]}function y(s){const e=$(),{count:t}=e;e.unsubscribe(s),t&&!e.count&&Vt()}function we(s){return $().subscribe(s),()=>y(s)}class Pt{constructor(e,t={}){this.scope=e,this.options=t}print(e,...t){const n=new Date,i=Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(n),{textColor:r,bgColor:o}=this.options,c="font-weight: bold;padding: 0 5px;border-radius:5px";console[e](`%c${i}%c / %c${this.scope}`,`${c};background-color: lightblue;color:black`,"",`${c};${r?`color:${r};`:""}${o?`background-color:${o}`:""}`,...t)}error(...e){this.print("error",...e)}log(...e){this.print("log",...e)}}const j=new Pt("SDK",{bgColor:"forestgreen",textColor:"white"});let z=!1;const me=({name:s,payload:e})=>{j.log("Event received:",e?{name:s,payload:e}:{name:s})};function Rt(s){z!==s&&(z=s,s?we(me):y(me))}function Tt(...s){z&&j.log(...s)}class R{constructor(){h(this,"listeners",new Map);h(this,"listenersCount",0);h(this,"subscribeListeners",[])}clear(){this.listeners.clear(),this.subscribeListeners=[]}get count(){return this.listenersCount+this.subscribeListeners.length}emit(e,...t){this.subscribeListeners.forEach(i=>i({event:e,args:t})),(this.listeners.get(e)||[]).forEach(([i,r])=>{i(...t),r&&this.off(e,i)})}on(e,t,n){let i=this.listeners.get(e);return i||this.listeners.set(e,i=[]),i.push([t,n]),this.listenersCount+=1,()=>this.off(e,t)}off(e,t){const n=this.listeners.get(e)||[];for(let i=0;i<n.length;i+=1)if(t===n[i][0]){n.splice(i,1),this.listenersCount-=1;return}}subscribe(e){return this.subscribeListeners.push(e),()=>this.unsubscribe(e)}unsubscribe(e){for(let t=0;t<this.subscribeListeners.length;t+=1)if(this.subscribeListeners[t]===e){this.subscribeListeners.splice(t,1);return}}}function F(s,e,t){return window.addEventListener(s,e,t),()=>window.removeEventListener(s,e,t)}function J(...s){let e=!1;const t=s.flat(1);return[n=>!e&&t.push(n),()=>{e||(e=!0,t.forEach(n=>n()))},e]}class k extends Error{constructor(e,t,n){super(t,{cause:n}),this.type=e,Object.setPrototypeOf(this,k.prototype)}}function g(s,e,t){return new k(s,e,t)}const ye="ERR_METHOD_UNSUPPORTED",Ee="ERR_METHOD_PARAMETER_UNSUPPORTED",ve="ERR_UNKNOWN_ENV",Se="ERR_INVOKE_CUSTOM_METHOD_RESPONSE",Pe="ERR_TIMED_OUT",Re="ERR_UNEXPECTED_TYPE",Y="ERR_PARSE",Te="ERR_NAVIGATION_LIST_EMPTY",Ce="ERR_NAVIGATION_CURSOR_INVALID",Ct="ERR_NAVIGATION_ITEM_INVALID",At="ERR_SSR_INIT",Ae="ERR_INVALID_PATH_BASE";function T(){return g(Re,"Value has unexpected type")}class U{constructor(e,t,n){this.parser=e,this.isOptional=t,this.type=n}parse(e){if(!(this.isOptional&&e===void 0))try{return this.parser(e)}catch(t){throw g(Y,`Unable to parse value${this.type?` as ${this.type}`:""}`,t)}}optional(){return this.isOptional=!0,this}}function C(s,e){return()=>new U(s,!1,e)}const E=C(s=>{if(typeof s=="boolean")return s;const e=String(s);if(e==="1"||e==="true")return!0;if(e==="0"||e==="false")return!1;throw T()},"boolean");function Ie(s,e){const t={};for(const n in s){const i=s[n];if(!i)continue;let r,o;if(typeof i=="function"||"parse"in i)r=n,o=typeof i=="function"?i:i.parse.bind(i);else{const{type:c}=i;r=i.from||n,o=typeof c=="function"?c:c.parse.bind(c)}try{const c=o(e(r));c!==void 0&&(t[n]=c)}catch(c){throw g(Y,`Unable to parse field "${n}"`,c)}}return t}function Ne(s){let e=s;if(typeof e=="string"&&(e=JSON.parse(e)),typeof e!="object"||e===null||Array.isArray(e))throw T();return e}function w(s,e){return new U(t=>{const n=Ne(t);return Ie(s,i=>n[i])},!1,e)}const S=C(s=>{if(typeof s=="number")return s;if(typeof s=="string"){const e=Number(s);if(!Number.isNaN(e))return e}throw T()},"number"),u=C(s=>{if(typeof s=="string"||typeof s=="number")return s.toString();throw T()},"string");function qe(s){return w({eventType:u(),eventData:e=>e}).parse(s)}function It(){["TelegramGameProxy_receiveEvent","TelegramGameProxy","Telegram"].forEach(s=>{delete window[s]})}function K(s,e){window.dispatchEvent(new MessageEvent("message",{data:JSON.stringify({eventType:s,eventData:e}),source:window.parent}))}function Nt(){[["TelegramGameProxy_receiveEvent"],["TelegramGameProxy","receiveEvent"],["Telegram","WebView","receiveEvent"]].forEach(s=>{let e=window;s.forEach((t,n,i)=>{if(n===i.length-1){e[t]=K;return}t in e||(e[t]={}),e=e[t]})})}const qt={clipboard_text_received:w({req_id:u(),data:s=>s===null?s:u().optional().parse(s)}),custom_method_invoked:w({req_id:u(),result:s=>s,error:u().optional()}),popup_closed:{parse(s){return w({button_id:e=>e==null?void 0:u().parse(e)}).parse(s??{})}},viewport_changed:w({height:S(),width:s=>s==null?window.innerWidth:S().parse(s),is_state_stable:E(),is_expanded:E()})};function kt(){const s=new R,e=new R;e.subscribe(n=>{s.emit("event",{name:n.event,payload:n.args[0]})}),Nt();const[,t]=J(It,F("resize",()=>{e.emit("viewport_changed",{width:window.innerWidth,height:window.innerHeight,is_state_stable:!0,is_expanded:!0})}),F("message",n=>{if(n.source!==window.parent)return;let i;try{i=qe(n.data)}catch{return}const{eventType:r,eventData:o}=i,c=qt[r];try{const p=c?c.parse(o):o;e.emit(...p?[r,p]:[r])}catch(p){j.error(`An error occurred processing the "${r}" event from the Telegram application.
Please, file an issue here:
https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose`,i,p)}}),()=>s.clear(),()=>e.clear());return[{on:e.on.bind(e),off:e.off.bind(e),subscribe(n){return s.on("event",n)},unsubscribe(n){s.off("event",n)},get count(){return e.count+s.count}},t]}const[Dt,Vt]=b(s=>{const[e,t]=kt(),n=e.off.bind(e);return e.off=(i,r)=>{const{count:o}=e;n(i,r),o&&!e.count&&s()},[e,t]},([,s])=>s());function $(){return Dt()[0]}function D(s,e){$().off(s,e)}function m(s,e,t){return $().on(s,e,t)}function V(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function ke(s,e){const t=s.split("."),n=e.split("."),i=Math.max(t.length,n.length);for(let r=0;r<i;r+=1){const o=parseInt(t[r]||"0",10),c=parseInt(n[r]||"0",10);if(o!==c)return o>c?1:-1}return 0}function f(s,e){return ke(s,e)<=0}function P(s,e,t){if(typeof t=="string"){if(s==="web_app_open_link"){if(e==="try_instant_view")return f("6.4",t);if(e==="try_browser")return f("7.6",t)}if(s==="web_app_set_header_color"&&e==="color")return f("6.9",t);if(s==="web_app_close"&&e==="return_back")return f("7.6",t)}switch(s){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return f("6.1",e);case"web_app_open_popup":return f("6.2",e);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return f("6.4",e);case"web_app_switch_inline_query":return f("6.7",e);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return f("6.9",e);case"web_app_setup_settings_button":return f("6.10",e);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return f("7.2",e);case"web_app_setup_swipe_behavior":return f("7.7",e);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(s)}}function De(s){return"external"in s&&V(s.external)&&"notify"in s.external&&typeof s.external.notify=="function"}function Ve(s){return"TelegramWebviewProxy"in s&&V(s.TelegramWebviewProxy)&&"postEvent"in s.TelegramWebviewProxy&&typeof s.TelegramWebviewProxy.postEvent=="function"}function Q(){try{return window.self!==window.top}catch{return!0}}let Be="https://web.telegram.org";function Bt(s){Be=s}function Me(){return Be}function A(s,e,t){let n={},i;if(!e&&!t?n={}:e&&t?(n=t,i=e):e&&("targetOrigin"in e?n=e:i=e),Tt("Posting event:",i?{event:s,data:i}:{event:s}),Q())return window.parent.postMessage(JSON.stringify({eventType:s,eventData:i}),n.targetOrigin||Me());if(De(window)){window.external.notify(JSON.stringify({eventType:s,eventData:i}));return}if(Ve(window)){window.TelegramWebviewProxy.postEvent(s,JSON.stringify(i));return}throw g(ve,"Unable to determine current environment and possible way to send event. You are probably trying to use Mini Apps method outside the Telegram application environment.")}function Le(s){return(e,t)=>{if(!P(e,s))throw g(ye,`Method "${e}" is unsupported in Mini Apps version ${s}`);if(V(t)&&e==="web_app_set_header_color"&&"color"in t&&!P(e,"color",s))throw g(Ee,`Parameter "color" of "${e}" method is unsupported in Mini Apps version ${s}`);return A(e,t)}}function X(s){return({req_id:e})=>e===s}function Oe(s){return g(Pe,`Timeout reached: ${s}ms`)}function Z(s,e){return Promise.race([typeof s=="function"?s():s,new Promise((t,n)=>{setTimeout(()=>{n(Oe(e))},e)})])}async function _(s){let e;const t=new Promise(c=>e=c),{event:n,capture:i,timeout:r}=s,[,o]=J((Array.isArray(n)?n:[n]).map(c=>m(c,p=>{(!i||(Array.isArray(n)?i({event:c,payload:p}):i(p)))&&e(p)})));try{return(s.postEvent||A)(s.method,s.params),await(r?Z(t,r):t)}finally{o()}}async function I(s,e,t,n={}){const{result:i,error:r}=await _({...n,method:"web_app_invoke_custom_method",event:"custom_method_invoked",params:{method:s,params:e,req_id:t},capture:X(t)});if(r)throw g(Se,r);return i}function W(...s){return s.map(e=>{if(typeof e=="string")return e;if(V(e))return W(Object.entries(e).map(t=>t[1]&&t[0]));if(Array.isArray(e))return W(...e)}).filter(Boolean).join(" ")}function Mt(...s){return s.reduce((e,t)=>(V(t)&&Object.entries(t).forEach(([n,i])=>{const r=W(e[n],i);r.length&&(e[n]=r)}),e),{})}function H(s){return/^#[\da-f]{6}$/i.test(s)}function Ue(s){return/^#[\da-f]{3}$/i.test(s)}function ee(s){const e=s.replace(/\s/g,"").toLowerCase();if(H(e))return e;if(Ue(e)){let n="#";for(let i=0;i<3;i+=1)n+=e[1+i].repeat(2);return n}const t=e.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||e.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!t)throw new Error(`Value "${s}" does not satisfy any of known RGB formats.`);return t.slice(1).reduce((n,i)=>{const r=parseInt(i,10).toString(16);return n+(r.length===1?"0":"")+r},"#")}function te(s){const e=ee(s);return Math.sqrt([.299,.587,.114].reduce((t,n,i)=>{const r=parseInt(e.slice(1+i*2,1+(i+1)*2),16);return t+r*r*n},0))<120}class Lt{constructor(e){h(this,"ee",new R);h(this,"on",this.ee.on.bind(this.ee));h(this,"off",this.ee.off.bind(this.ee));this.state=e}clone(){return{...this.state}}set(e,t){Object.entries(typeof e=="string"?{[e]:t}:e).reduce((i,[r,o])=>this.state[r]===o||o===void 0?i:(this.state[r]=o,this.ee.emit(`change:${r}`,o),!0),!1)&&this.ee.emit("change",this.state)}get(e){return this.state[e]}}class se{constructor(e){h(this,"state");h(this,"get");h(this,"set");h(this,"clone");this.state=new Lt(e),this.set=this.state.set.bind(this.state),this.get=this.state.get.bind(this.state),this.clone=this.state.clone.bind(this.state)}}function $e(s,e){return t=>P(e[t],s)}class ne extends se{constructor(t,n,i){super(t);h(this,"supports");this.supports=$e(n,i)}}class We extends ne{constructor(t,n,i){super({isVisible:t},n,{show:"web_app_setup_back_button",hide:"web_app_setup_back_button"});h(this,"on",(t,n)=>t==="click"?m("back_button_pressed",n):this.state.on(t,n));h(this,"off",(t,n)=>t==="click"?D("back_button_pressed",n):this.state.off(t,n));this.postEvent=i}set isVisible(t){this.set("isVisible",t),this.postEvent("web_app_setup_back_button",{is_visible:t})}get isVisible(){return this.get("isVisible")}hide(){this.isVisible=!1}show(){this.isVisible=!0}}const ie=C(s=>s instanceof Date?s:new Date(S().parse(s)*1e3),"Date");function G(s,e){return new U(t=>{if(typeof t!="string"&&!(t instanceof URLSearchParams))throw T();const n=typeof t=="string"?new URLSearchParams(t):t;return Ie(s,i=>{const r=n.get(i);return r===null?void 0:r})},!1,e)}const Ot=w({id:S(),type:u(),title:u(),photoUrl:{type:u().optional(),from:"photo_url"},username:u().optional()},"Chat").optional(),He=w({addedToAttachmentMenu:{type:E().optional(),from:"added_to_attachment_menu"},allowsWriteToPm:{type:E().optional(),from:"allows_write_to_pm"},firstName:{type:u(),from:"first_name"},id:S(),isBot:{type:E().optional(),from:"is_bot"},isPremium:{type:E().optional(),from:"is_premium"},languageCode:{type:u().optional(),from:"language_code"},lastName:{type:u().optional(),from:"last_name"},photoUrl:{type:u().optional(),from:"photo_url"},username:u().optional()},"User").optional();function Ge(){return G({authDate:{type:ie(),from:"auth_date"},canSendAfter:{type:S().optional(),from:"can_send_after"},chat:Ot,chatInstance:{type:u().optional(),from:"chat_instance"},chatType:{type:u().optional(),from:"chat_type"},hash:u(),queryId:{type:u().optional(),from:"query_id"},receiver:He,startParam:{type:u().optional(),from:"start_param"},user:He},"InitData")}const xe=C(s=>ee(u().parse(s)),"rgb");function Ut(s){return s.replace(/_[a-z]/g,e=>e[1].toUpperCase())}function $t(s){return s.replace(/[A-Z]/g,e=>`_${e.toLowerCase()}`)}const je=C(s=>{const e=xe().optional();return Object.entries(Ne(s)).reduce((t,[n,i])=>(t[Ut(n)]=e.parse(i),t),{})},"ThemeParams");function x(s){return G({botInline:{type:E().optional(),from:"tgWebAppBotInline"},initData:{type:Ge().optional(),from:"tgWebAppData"},initDataRaw:{type:u().optional(),from:"tgWebAppData"},platform:{type:u(),from:"tgWebAppPlatform"},showSettings:{type:E().optional(),from:"tgWebAppShowSettings"},startParam:{type:u().optional(),from:"tgWebAppStartParam"},themeParams:{type:je(),from:"tgWebAppThemeParams"},version:{type:u(),from:"tgWebAppVersion"}}).parse(s)}function ze(s){return x(s.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&"))}function Wt(){return ze(window.location.href)}function Fe(){return performance.getEntriesByType("navigation")[0]}function Ht(){const s=Fe();if(!s)throw new Error("Unable to get first navigation entry.");return ze(s.name)}function Je(s){return`telegram-apps/${s.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}`}function Ye(s,e){sessionStorage.setItem(Je(s),JSON.stringify(e))}function Ke(s){const e=sessionStorage.getItem(Je(s));try{return e?JSON.parse(e):void 0}catch{}}function Gt(){return x(Ke("launchParams")||"")}function re(s){return JSON.stringify(Object.fromEntries(Object.entries(s).map(([e,t])=>[$t(e),t])))}function Qe(s){const{initDataRaw:e,themeParams:t,platform:n,version:i,showSettings:r,startParam:o,botInline:c}=s,p=new URLSearchParams;return p.set("tgWebAppPlatform",n),p.set("tgWebAppThemeParams",re(t)),p.set("tgWebAppVersion",i),e&&p.set("tgWebAppData",e),o&&p.set("tgWebAppStartParam",o),typeof r=="boolean"&&p.set("tgWebAppShowSettings",r?"1":"0"),typeof c=="boolean"&&p.set("tgWebAppBotInline",c?"1":"0"),p.toString()}function Xe(s){Ye("launchParams",Qe(s))}function Ze(){const s=[];for(const e of[Wt,Ht,Gt])try{const t=e();return Xe(t),t}catch(t){s.push(t instanceof Error?t.message:JSON.stringify(t))}throw new Error([`Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?
`,"📖 Refer to docs for more information:",`https://docs.telegram-mini-apps.com/packages/telegram-apps-sdk/environment
`,"Collected errors:",s.map(e=>`— ${e}`)].join(`
`))}function ae(){const s=Fe();return!!(s&&s.type==="reload")}function xt(){let s=0;return()=>(s+=1).toString()}const[jt]=b(xt);function l(s,e){return()=>{const t=Ze(),n={...t,postEvent:Le(t.version),createRequestId:jt()};if(typeof s=="function")return s(n);const[i,r,o]=J(),c=e({...n,state:ae()?Ke(s):void 0,addCleanup:i}),p=d=>(o||i(d.on("change",Cs=>{Ye(s,Cs)})),d);return[c instanceof Promise?c.then(p):p(c),r]}}const zt=l("backButton",({postEvent:s,version:e,state:t={isVisible:!1}})=>new We(t.isVisible,e,s));class N extends ne{constructor(){super(...arguments);h(this,"on",this.state.on.bind(this.state));h(this,"off",this.state.off.bind(this.state))}}function et(s){const e=s.available?s:{available:!1,device_id:"",token_saved:!1,access_requested:!1,access_granted:!1,type:""};return{available:!0,type:e.type,deviceId:e.device_id,tokenSaved:e.token_saved,accessRequested:e.access_requested,accessGranted:e.access_granted}}class tt extends N{constructor({postEvent:t,version:n,...i}){super(i,n,{auth:"web_app_biometry_request_auth",openSettings:"web_app_biometry_open_settings",requestAccess:"web_app_biometry_request_access",updateToken:"web_app_biometry_update_token"});h(this,"postEvent");h(this,"authPromise");h(this,"accessPromise");this.postEvent=t}get available(){return this.get("available")}get accessGranted(){return this.get("accessGranted")}get accessRequested(){return this.get("accessRequested")}async authenticate({reason:t,...n}){return this.authPromise||(this.authPromise=_({...n,method:"web_app_biometry_request_auth",event:"biometry_auth_requested",postEvent:this.postEvent,params:{reason:(t||"").trim()}}).then(({token:i})=>i).finally(()=>this.authPromise=void 0)),this.authPromise}get deviceId(){return this.get("deviceId")}openSettings(){this.postEvent("web_app_biometry_open_settings")}requestAccess({reason:t,...n}={}){return this.accessPromise||(this.accessPromise=_({...n,postEvent:this.postEvent,method:"web_app_biometry_request_access",event:"biometry_info_received",params:{reason:t||""}}).then(i=>{const r=et(i);return this.set(r),r.accessGranted}).finally(()=>this.accessPromise=void 0)),this.accessPromise}get biometryType(){return this.get("biometryType")}get tokenSaved(){return this.get("tokenSaved")}async updateToken({token:t,...n}={}){return["removed","updated"].includes((await _({...n,postEvent:this.postEvent,method:"web_app_biometry_update_token",event:"biometry_token_updated",params:{token:t||""}})).status)}}async function st(s){return et(await _({...s||{},method:"web_app_biometry_get_info",event:"biometry_info_received"}))}const Ft=l("biometryManager",async({postEvent:s,version:e,state:t})=>new tt({...t||P("web_app_biometry_get_info",e)?t||await st({timeout:1e3}):{available:!1,accessGranted:!1,accessRequested:!1,tokenSaved:!1,deviceId:""},version:e,postEvent:s}));class oe extends se{constructor(){super(...arguments);h(this,"on",this.state.on.bind(this.state));h(this,"off",this.state.off.bind(this.state))}}class nt extends oe{constructor(e,t){super({isConfirmationNeeded:e}),this.postEvent=t}set isConfirmationNeeded(e){this.set("isConfirmationNeeded",e),this.postEvent("web_app_setup_closing_behavior",{need_confirmation:e})}get isConfirmationNeeded(){return this.get("isConfirmationNeeded")}disableConfirmation(){this.isConfirmationNeeded=!1}enableConfirmation(){this.isConfirmationNeeded=!0}}const Jt=l("closingBehavior",({postEvent:s,state:e={isConfirmationNeeded:!1}})=>new nt(e.isConfirmationNeeded,s));class ce{constructor(e,t){h(this,"supports");this.supports=$e(e,t)}}function Yt(s){if(Array.isArray(s))return s;if(typeof s=="string")try{const e=JSON.parse(s);if(Array.isArray(e))return e}catch{}throw T()}class Kt extends U{constructor(t,n,i){super(Yt,n,i);h(this,"itemParser");this.itemParser=typeof t=="function"?t:t.parse.bind(t)}parse(t){const n=super.parse(t);return n===void 0?n:n.map(this.itemParser)}of(t){return this.itemParser=typeof t=="function"?t:t.parse.bind(t),this}}function it(s){return new Kt(e=>e,!1,s)}function rt(s,e){return Object.fromEntries(s.map(t=>[t,e]))}class at extends ce{constructor(e,t,n){super(e,{delete:"web_app_invoke_custom_method",get:"web_app_invoke_custom_method",getKeys:"web_app_invoke_custom_method",set:"web_app_invoke_custom_method"}),this.createRequestId=t,this.postEvent=n}async delete(e,t={}){const n=Array.isArray(e)?e:[e];n.length&&await I("deleteStorageValues",{keys:n},this.createRequestId(),{...t,postEvent:this.postEvent})}async getKeys(e={}){return it().of(u()).parse(await I("getStorageKeys",{},this.createRequestId(),{...e,postEvent:this.postEvent}))}async get(e,t={}){const n=Array.isArray(e)?e:[e];if(!n.length)return rt(n,"");const i=await I("getStorageValues",{keys:n},this.createRequestId(),{...t,postEvent:this.postEvent}),r=w(rt(n,u()),"CloudStorageData").parse(i);return Array.isArray(e)?r:r[e]}async set(e,t,n={}){await I("saveStorageValue",{key:e,value:t},this.createRequestId(),{...n,postEvent:this.postEvent})}}const Qt=l(({createRequestId:s,postEvent:e,version:t})=>new at(t,s,e));class ot extends ce{constructor(e,t){super(e,{impactOccurred:"web_app_trigger_haptic_feedback",notificationOccurred:"web_app_trigger_haptic_feedback",selectionChanged:"web_app_trigger_haptic_feedback"}),this.postEvent=t}impactOccurred(e){this.postEvent("web_app_trigger_haptic_feedback",{type:"impact",impact_style:e})}notificationOccurred(e){this.postEvent("web_app_trigger_haptic_feedback",{type:"notification",notification_type:e})}selectionChanged(){this.postEvent("web_app_trigger_haptic_feedback",{type:"selection_change"})}}const Xt=l(({version:s,postEvent:e})=>new ot(s,e));class ct{constructor(e){this.initData=e}get authDate(){return this.initData.authDate}get canSendAfter(){return this.initData.canSendAfter}get canSendAfterDate(){const{canSendAfter:e}=this;return e?new Date(this.authDate.getTime()+e*1e3):void 0}get chat(){return this.initData.chat}get chatType(){return this.initData.chatType}get chatInstance(){return this.initData.chatInstance}get hash(){return this.initData.hash}get queryId(){return this.initData.queryId}get receiver(){return this.initData.receiver}get startParam(){return this.initData.startParam}get user(){return this.initData.user}}const Zt=l(({initData:s})=>s?new ct(s):void 0);function es(s){return Ge().parse(s)}class ht extends N{constructor(e,t,n){super({isOpened:e},t,{open:"web_app_open_invoice"}),this.postEvent=n}set isOpened(e){this.set("isOpened",e)}get isOpened(){return this.get("isOpened")}async open(e,t){if(this.isOpened)throw new Error("Invoice is already opened");let n;if(!t)n=e;else{const{hostname:i,pathname:r}=new URL(e,window.location.href);if(i!=="t.me")throw new Error(`Incorrect hostname: ${i}`);const o=r.match(/^\/(\$|invoice\/)([A-Za-z0-9\-_=]+)$/);if(!o)throw new Error('Link pathname has incorrect format. Expected to receive "/invoice/{slug}" or "/${slug}"');[,,n]=o}this.isOpened=!0;try{return(await _({method:"web_app_open_invoice",event:"invoice_closed",params:{slug:n},postEvent:this.postEvent,capture(r){return n===r.slug}})).status}finally{this.isOpened=!1}}}const ts=l(({version:s,postEvent:e})=>new ht(!1,s,e));class pt extends se{constructor({postEvent:t,...n}){super(n);h(this,"postEvent");h(this,"on",(t,n)=>t==="click"?m("main_button_pressed",n):this.state.on(t,n));h(this,"off",(t,n)=>t==="click"?D("main_button_pressed",n):this.state.off(t,n));this.postEvent=t}get bgColor(){return this.get("bgColor")}commit(){this.text!==""&&this.postEvent("web_app_setup_main_button",{is_visible:this.isVisible,is_active:this.isEnabled,is_progress_visible:this.isLoaderVisible,text:this.text,color:this.bgColor,text_color:this.textColor})}disable(){return this.isEnabled=!1,this}enable(){return this.isEnabled=!0,this}hide(){return this.isVisible=!1,this}hideLoader(){return this.isLoaderVisible=!1,this}set isEnabled(t){this.setParams({isEnabled:t})}get isEnabled(){return this.get("isEnabled")}set isLoaderVisible(t){this.setParams({isLoaderVisible:t})}get isLoaderVisible(){return this.get("isLoaderVisible")}set isVisible(t){this.setParams({isVisible:t})}get isVisible(){return this.get("isVisible")}show(){return this.isVisible=!0,this}showLoader(){return this.isLoaderVisible=!0,this}setText(t){return this.setParams({text:t})}setTextColor(t){return this.setParams({textColor:t})}setBgColor(t){return this.setParams({bgColor:t})}setParams(t){return this.set(t),this.commit(),this}get text(){return this.get("text")}get textColor(){return this.get("textColor")}}const ss=l("mainButton",({postEvent:s,themeParams:e,state:t={isVisible:!1,isEnabled:!1,text:"",isLoaderVisible:!1,textColor:e.buttonTextColor||"#ffffff",bgColor:e.buttonColor||"#000000"}})=>new pt({...t,postEvent:s}));function ns(){return G({contact:w({userId:{type:S(),from:"user_id"},phoneNumber:{type:u(),from:"phone_number"},firstName:{type:u(),from:"first_name"},lastName:{type:u().optional(),from:"last_name"}}),authDate:{type:ie(),from:"auth_date"},hash:u()},"RequestedContact")}function ut(s,e){return t=>{const[n,i]=e[t];return P(n,i,s)}}function is(s){return new Promise(e=>{setTimeout(e,s)})}class lt extends N{constructor({postEvent:t,createRequestId:n,version:i,botInline:r,...o}){super(o,i,{requestPhoneAccess:"web_app_request_phone",requestWriteAccess:"web_app_request_write_access",switchInlineQuery:"web_app_switch_inline_query",setHeaderColor:"web_app_set_header_color",setBackgroundColor:"web_app_set_background_color"});h(this,"botInline");h(this,"postEvent");h(this,"createRequestId");h(this,"requestPhoneAccessPromise");h(this,"requestWriteAccessPromise");h(this,"supportsParam");this.createRequestId=n,this.postEvent=t,this.botInline=r;const c=this.supports.bind(this);this.supports=p=>c(p)?p!=="switchInlineQuery"||r:!1,this.supportsParam=ut(i,{"setHeaderColor.color":["web_app_set_header_color","color"],"close.returnBack":["web_app_close","return_back"]})}async getRequestedContact({timeout:t=1e4}={}){return ns().parse(await I("getRequestedContact",{},this.createRequestId(),{postEvent:this.postEvent,timeout:t}))}get bgColor(){return this.get("bgColor")}close(t){this.postEvent("web_app_close",this.supportsParam("close.returnBack")?{return_back:t}:{})}get headerColor(){return this.get("headerColor")}get isBotInline(){return this.botInline}get isDark(){return te(this.bgColor)}ready(){this.postEvent("web_app_ready")}async requestContact({timeout:t=5e3}={}){try{return await this.getRequestedContact()}catch{}if(await this.requestPhoneAccess()!=="sent")throw new Error("Access denied.");const i=Date.now()+t;let r=50;return Z(async()=>{for(;Date.now()<i;){try{return await this.getRequestedContact()}catch{}await is(r),r+=50}throw Oe(t)},t)}async requestPhoneAccess(t={}){return this.requestPhoneAccessPromise||(this.requestPhoneAccessPromise=_({...t,method:"web_app_request_phone",event:"phone_requested",postEvent:this.postEvent}).then(({status:n})=>n).finally(()=>this.requestPhoneAccessPromise=void 0)),this.requestPhoneAccessPromise}async requestWriteAccess(t={}){return this.requestWriteAccessPromise||(this.requestWriteAccessPromise=_({...t,method:"web_app_request_write_access",event:"write_access_requested",postEvent:this.postEvent}).then(({status:n})=>n).finally(()=>this.requestWriteAccessPromise=void 0)),this.requestWriteAccessPromise}sendData(t){const{size:n}=new Blob([t]);if(!n||n>4096)throw new Error(`Passed data has incorrect size: ${n}`);this.postEvent("web_app_data_send",{data:t})}setHeaderColor(t){this.postEvent("web_app_set_header_color",H(t)?{color:t}:{color_key:t}),this.set("headerColor",t)}setBgColor(t){this.postEvent("web_app_set_background_color",{color:t}),this.set("bgColor",t)}switchInlineQuery(t,n=[]){if(!this.supports("switchInlineQuery")&&!this.isBotInline)throw new Error("Method is unsupported because Mini App should be launched in inline mode.");this.postEvent("web_app_switch_inline_query",{query:t,chat_types:n})}}const rs=l("miniApp",({themeParams:s,botInline:e=!1,state:t={bgColor:s.bgColor||"#ffffff",headerColor:s.headerBgColor||"#000000"},...n})=>new lt({...n,...t,botInline:e}));function as(s){const e=s.message.trim(),t=(s.title||"").trim(),n=s.buttons||[];let i;if(t.length>64)throw new Error(`Title has incorrect size: ${t.length}`);if(!e.length||e.length>256)throw new Error(`Message has incorrect size: ${e.length}`);if(n.length>3)throw new Error(`Buttons have incorrect size: ${n.length}`);return n.length?i=n.map(r=>{const{id:o=""}=r;if(o.length>64)throw new Error(`Button ID has incorrect size: ${o}`);if(!r.type||r.type==="default"||r.type==="destructive"){const c=r.text.trim();if(!c.length||c.length>64){const p=r.type||"default";throw new Error(`Button text with type "${p}" has incorrect size: ${r.text.length}`)}return{...r,text:c,id:o}}return{...r,id:o}}):i=[{type:"close",id:""}],{title:t,message:e,buttons:i}}class dt extends N{constructor(e,t,n){super({isOpened:e},t,{open:"web_app_open_popup"}),this.postEvent=n}set isOpened(e){this.set("isOpened",e)}get isOpened(){return this.get("isOpened")}async open(e){if(this.isOpened)throw new Error("Popup is already opened.");this.isOpened=!0;try{const{button_id:t=null}=await _({event:"popup_closed",method:"web_app_open_popup",postEvent:this.postEvent,params:as(e)});return t}finally{this.isOpened=!1}}}const os=l(({postEvent:s,version:e})=>new dt(!1,e,s));class _t extends N{constructor(e,t,n){super({isOpened:e},t,{close:"web_app_close_scan_qr_popup",open:"web_app_open_scan_qr_popup"}),this.postEvent=n}close(){this.postEvent("web_app_close_scan_qr_popup"),this.isOpened=!1}set isOpened(e){this.set("isOpened",e)}get isOpened(){return this.get("isOpened")}async open(e){if(this.isOpened)throw new Error("The scanner is already opened");const{text:t,capture:n}=(typeof e=="string"?{text:e}:e)||{};this.isOpened=!0;try{const r=(await _({method:"web_app_open_scan_qr_popup",event:["qr_text_received","scan_qr_popup_closed"],postEvent:this.postEvent,params:{text:t},capture(o){return o.event==="scan_qr_popup_closed"||!n||n(o.payload)}})||{}).data||null;return r&&this.close(),r}finally{this.isOpened=!1}}}const cs=l(({version:s,postEvent:e})=>new _t(!1,s,e));class ft extends ne{constructor(t,n,i){super({isVisible:t},n,{show:"web_app_setup_settings_button",hide:"web_app_setup_settings_button"});h(this,"on",(t,n)=>t==="click"?m("settings_button_pressed",n):this.state.on(t,n));h(this,"off",(t,n)=>t==="click"?D("settings_button_pressed",n):this.state.off(t,n));this.postEvent=i}set isVisible(t){this.set("isVisible",t),this.postEvent("web_app_setup_settings_button",{is_visible:t})}get isVisible(){return this.get("isVisible")}hide(){this.isVisible=!1}show(){this.isVisible=!0}}const hs=l("settingsButton",({version:s,postEvent:e,state:t={isVisible:!1}})=>new ft(t.isVisible,s,e));class gt extends N{constructor(e,t,n){super({isVerticalSwipeEnabled:e},t,{disableVerticalSwipe:"web_app_setup_swipe_behavior",enableVerticalSwipe:"web_app_setup_swipe_behavior"}),this.postEvent=n}set isVerticalSwipeEnabled(e){this.set("isVerticalSwipeEnabled",e),this.postEvent("web_app_setup_swipe_behavior",{allow_vertical_swipe:e})}get isVerticalSwipeEnabled(){return this.get("isVerticalSwipeEnabled")}disableVerticalSwipe(){this.isVerticalSwipeEnabled=!1}enableVerticalSwipe(){this.isVerticalSwipeEnabled=!0}}const ps=l("swipeBehavior",({postEvent:s,state:e={isVerticalSwipeEnabled:!0},version:t})=>new gt(e.isVerticalSwipeEnabled,t,s));function he(s){return je().parse(s)}class bt extends oe{get accentTextColor(){return this.get("accentTextColor")}get bgColor(){return this.get("bgColor")}get buttonColor(){return this.get("buttonColor")}get buttonTextColor(){return this.get("buttonTextColor")}get destructiveTextColor(){return this.get("destructiveTextColor")}getState(){return this.clone()}get headerBgColor(){return this.get("headerBgColor")}get hintColor(){return this.get("hintColor")}get isDark(){return!this.bgColor||te(this.bgColor)}get linkColor(){return this.get("linkColor")}get secondaryBgColor(){return this.get("secondaryBgColor")}get sectionBgColor(){return this.get("sectionBgColor")}get sectionHeaderTextColor(){return this.get("sectionHeaderTextColor")}get sectionSeparatorColor(){return this.get("sectionHeaderTextColor")}listen(){return m("theme_changed",e=>{this.set(he(e.theme_params))})}get subtitleTextColor(){return this.get("subtitleTextColor")}get textColor(){return this.get("textColor")}}const us=l("themeParams",({themeParams:s,state:e=s,addCleanup:t})=>{const n=new bt(e);return t(n.listen()),n});function ls(s={}){return _({...s,method:"web_app_request_theme",event:"theme_changed"}).then(he)}function B(s,e){return s.startsWith(e)?s:`${e}${s}`}function q(s){return new URL(typeof s=="string"?s:`${s.pathname||""}${B(s.search||"","?")}${B(s.hash||"","#")}`,"http://a")}class wt extends ce{constructor(t,n,i){super(t,{readTextFromClipboard:"web_app_read_text_from_clipboard"});h(this,"supportsParam");this.version=t,this.createRequestId=n,this.postEvent=i,this.supportsParam=ut(t,{"openLink.tryInstantView":["web_app_open_link","try_instant_view"]})}openLink(t,n){const i=q(t).toString();if(!P("web_app_open_link",this.version)){window.open(i,"_blank");return}const r=typeof n=="boolean"?{tryInstantView:n}:n||{};this.postEvent("web_app_open_link",{url:i,try_browser:r.tryBrowser,try_instant_view:r.tryInstantView})}openTelegramLink(t){const{hostname:n,pathname:i,search:r}=new URL(t,"https://t.me");if(n!=="t.me")throw new Error(`URL has not allowed hostname: ${n}. Only "t.me" is allowed`);if(!P("web_app_open_tg_link",this.version)){window.location.href=t;return}this.postEvent("web_app_open_tg_link",{path_full:i+r})}async readTextFromClipboard(){const t=this.createRequestId(),{data:n=null}=await _({method:"web_app_read_text_from_clipboard",event:"clipboard_text_received",postEvent:this.postEvent,params:{req_id:t},capture:X(t)});return n}shareURL(t,n){this.openTelegramLink("https://t.me/share/url?"+new URLSearchParams({url:t,text:n||""}).toString().replace(/\+/g,"%20"))}}const ds=l(({version:s,postEvent:e,createRequestId:t})=>new wt(s,t,e));async function pe(s={}){const{is_expanded:e,is_state_stable:t,...n}=await _({...s,method:"web_app_request_viewport",event:"viewport_changed"});return{...n,isExpanded:e,isStateStable:t}}function M(s){return s<0?0:s}class mt extends oe{constructor({postEvent:t,stableHeight:n,height:i,width:r,isExpanded:o}){super({height:M(i),isExpanded:o,stableHeight:M(n),width:M(r)});h(this,"postEvent");this.postEvent=t}async sync(t){const{isStateStable:n,...i}=await pe(t);this.set({...i,stableHeight:n?i.height:this.get("stableHeight")})}get height(){return this.get("height")}get stableHeight(){return this.get("stableHeight")}listen(){return m("viewport_changed",t=>{const{height:n,width:i,is_expanded:r,is_state_stable:o}=t,c=M(n);this.set({height:c,isExpanded:r,width:M(i),...o?{stableHeight:c}:{}})})}get isExpanded(){return this.get("isExpanded")}get width(){return this.get("width")}expand(){this.postEvent("web_app_expand"),this.set("isExpanded",!0)}get isStable(){return this.stableHeight===this.height}}const _s=l("viewport",async({state:s,platform:e,postEvent:t,addCleanup:n})=>{let i=!1,r=0,o=0,c=0;if(s)i=s.isExpanded,r=s.height,o=s.width,c=s.stableHeight;else if(["macos","tdesktop","unigram","webk","weba","web"].includes(e))i=!0,r=window.innerHeight,o=window.innerWidth,c=window.innerHeight;else{const d=await pe({timeout:1e3,postEvent:t});i=d.isExpanded,r=d.height,o=d.width,c=d.isStateStable?r:0}const p=new mt({postEvent:t,height:r,width:o,stableHeight:c,isExpanded:i});return n(p.listen()),p});function v(s,e){document.documentElement.style.setProperty(s,e)}function fs(s,e,t){t||(t=c=>`--tg-${c}-color`);const n=t("header"),i=t("bg"),r=()=>{const{headerColor:c}=s;if(H(c))v(n,c);else{const{bgColor:p,secondaryBgColor:d}=e;c==="bg_color"&&p?v(n,p):c==="secondary_bg_color"&&d&&v(n,d)}v(i,s.bgColor)},o=[e.on("change",r),s.on("change",r)];return r(),()=>o.forEach(c=>c())}function gs(s,e){e||(e=n=>`--tg-theme-${n.replace(/[A-Z]/g,i=>`-${i.toLowerCase()}`)}`);const t=()=>{Object.entries(s.getState()).forEach(([n,i])=>{i&&v(e(n),i)})};return t(),s.on("change",t)}function bs(s,e){e||(e=d=>`--tg-viewport-${d}`);const[t,n,i]=["height","width","stable-height"].map(d=>e(d)),r=()=>v(t,`${s.height}px`),o=()=>v(n,`${s.width}px`),c=()=>v(i,`${s.stableHeight}px`),p=[s.on("change:height",r),s.on("change:width",o),s.on("change:stableHeight",c)];return r(),o(),c(),()=>p.forEach(d=>d())}function ws(s=!0){const e=[m("reload_iframe",()=>{A("iframe_will_reload"),window.location.reload()})],t=()=>e.forEach(n=>n());if(s){const n=document.createElement("style");n.id="telegram-custom-styles",document.head.appendChild(n),e.push(m("set_custom_style",i=>{n.innerHTML=i}),()=>document.head.removeChild(n))}return A("iframe_ready",{reload_supported:!0}),t}function ms(){return typeof window>"u"}async function ys(){if(Ve(window))return!0;try{return await _({method:"web_app_request_theme",event:"theme_changed",timeout:100}),!0}catch{return!1}}function Es(s){const e=typeof s=="string"?x(s):s;Xe(e);function t(i){if(typeof i=="string")try{const{eventType:r}=qe(i);r==="web_app_request_theme"&&K("theme_changed",{theme_params:JSON.parse(re(e.themeParams))}),r==="web_app_request_viewport"&&K("viewport_changed",{width:window.innerWidth,height:window.innerHeight,is_state_stable:!0,is_expanded:!0})}catch{}}if(Q()){const i=window.parent.postMessage.bind(window.parent);window.parent.postMessage=r=>{t(r),i(r)};return}if(De(window)){const i=window.external.notify.bind(window.external);window.external.notify=r=>{t(r),i(r)};return}const n=window.TelegramWebviewProxy;window.TelegramWebviewProxy={...n||{},postEvent(...i){t(JSON.stringify({eventType:i[0],eventData:i[1]})),n&&n.postEvent(...i)}}}function yt(s){return s instanceof k}function vs(s,e){return yt(s)&&s.type===e}function ue(s,e){let t,n,i;return typeof s=="string"?t=s:(t=s.pathname===void 0?e:s.pathname,n=s.params,i=s.id),Object.freeze({id:i||(Math.random()*2**14|0).toString(16),pathname:t,params:n})}class Et{constructor(e,t,n=A){h(this,"history");h(this,"ee",new R);h(this,"attached",!1);h(this,"back",()=>this.go(-1));h(this,"on",this.ee.on.bind(this.ee));h(this,"off",this.ee.off.bind(this.ee));if(this._index=t,this.postEvent=n,e.length===0)throw g(Te,"History should not be empty.");if(t<0||t>=e.length)throw g(Ce,"Index should not be zero and higher or equal than history size.");this.history=e.map(i=>ue(i,""))}attach(){this.attached||(this.attached=!0,this.sync(),m("back_button_pressed",this.back))}get current(){return this.history[this.index]}detach(){this.attached=!1,D("back_button_pressed",this.back)}forward(){this.go(1)}go(e,t){const n=this.index+e,i=Math.min(Math.max(0,n),this.history.length-1);(n===i||t)&&this.replaceAndMove(i,this.history[i])}goTo(e,t){this.go(e-this.index,t)}get hasPrev(){return this.index>0}get hasNext(){return this.index!==this.history.length-1}get index(){return this._index}push(e){this.hasNext&&this.history.splice(this.index+1),this.replaceAndMove(this.index+1,ue(e,this.current.pathname))}replace(e){this.replaceAndMove(this.index,ue(e,this.current.pathname))}replaceAndMove(e,t){const n=e-this.index;if(!n&&this.current===t)return;const i=this.current;if(this.index!==e){const r=this._index;this._index=e,this.attached&&r>0!=e>0&&this.sync()}this.history[e]=t,this.ee.emit("change",{navigator:this,from:i,to:this.current,delta:n})}sync(){this.postEvent("web_app_setup_back_button",{is_visible:!!this.index})}}function le({params:s,...e}){return{...s||{hash:"",search:""},...e}}function L(s){const e=typeof s=="string"?s.startsWith("/"):!!(s.pathname&&s.pathname.startsWith("/")),t=q(s);return`${e?t.pathname:t.pathname.slice(1)}${t.search}${t.hash}`}function de(s,e,t){let n,i;typeof s=="string"?n=s:(n=L(s),t=s.state,i=s.id);const{pathname:r,search:o,hash:c}=new URL(n,`http://a${B(e,"/")}`);return{id:i,pathname:r,params:{hash:c,search:o,state:t}}}async function O(s){return s===0?!0:Promise.race([new Promise(e=>{const t=F("popstate",()=>{t(),e(!0)});window.history.go(s)}),new Promise(e=>{setTimeout(e,50,!1)})])}async function Ss(){if(window.history.length<=1||(window.history.pushState(null,""),await O(1-window.history.length)))return;let e=await O(-1);for(;e;)e=await O(-1)}function _e(s){return q(s).pathname}const vt=0,fe=1,ge=2;class be{constructor(e,t,{postEvent:n,hashMode:i="classic",base:r}={}){h(this,"navigator");h(this,"ee",new R);h(this,"hashMode");h(this,"base");h(this,"attached",!1);h(this,"onPopState",({state:e})=>{if(e===null)return this.push(this.parsePath(window.location.href));e===vt?window.history.forward():e===fe&&this.back(),e===ge&&this.forward()});h(this,"onNavigatorChange",async({to:e,from:t,delta:n})=>{this.attached&&await this.syncHistory(),this.ee.emit("change",{delta:n,from:le(t),to:le(e),navigator:this})});h(this,"on",this.ee.on.bind(this.ee));h(this,"off",this.ee.off.bind(this.ee));this.navigator=new Et(e.map(o=>de(o,"/")),t,n),this.navigator.on("change",o=>{this.onNavigatorChange(o)}),this.hashMode=i,this.base=_e(r||"")}async attach(){this.attached||(this.attached=!0,this.navigator.attach(),window.addEventListener("popstate",this.onPopState),await this.syncHistory())}back(){this.navigator.back()}detach(){this.attached=!1,this.navigator.detach(),window.removeEventListener("popstate",this.onPopState)}forward(){return this.navigator.forward()}get index(){return this.navigator.index}get id(){return this.navigator.current.id}go(e,t){return this.navigator.go(e,t)}goTo(e,t){this.navigator.goTo(e,t)}get hash(){return(this.navigator.current.params||{}).hash||""}get hasPrev(){return this.navigator.hasPrev}get hasNext(){return this.navigator.hasNext}get history(){return this.navigator.history.map(le)}get path(){return L(this)}get pathname(){return this.navigator.current.pathname}parsePath(e){let t=q(e);return this.hashMode&&(t=q(t.hash.slice(1))),{pathname:t.pathname,search:t.search,hash:t.hash}}push(e,t){const n=de(e,this.path),{state:i=t}=n.params;this.navigator.push({...n,params:{...n.params,state:i}})}replace(e,t){const n=de(e,this.path),{state:i=t}=n.params;this.navigator.replace({...n,params:{...n.params,state:i}})}renderPath(e){const t=(this.base.length===1?"":this.base)+B(L(e),"/");return this.hashMode?B(t.slice(1),this.hashMode==="classic"?"#":"#/"):t}async syncHistory(){window.removeEventListener("popstate",this.onPopState);const{state:e}=this,t=this.renderPath(this);await Ss(),this.hasPrev&&this.hasNext?(window.history.replaceState(fe,""),window.history.pushState(e,"",t),window.history.pushState(ge,""),await O(-1)):this.hasPrev?(window.history.replaceState(fe,""),window.history.pushState(e,"",t)):this.hasNext?(window.history.replaceState(e,t),window.history.pushState(ge,""),await O(-1)):(window.history.replaceState(vt,""),window.history.pushState(e,"",t)),window.addEventListener("popstate",this.onPopState)}get search(){return(this.navigator.current.params||{}).search||""}get state(){return(this.navigator.current.params||{}).state}}function St(s){s||(s={});const{href:e,hash:t}=window.location;let n=L(s.hashMode===null?e:t.includes("?")?t.slice(1):`?${t.slice(1)}`);const i=s.base?_e(s.base):void 0;if(i){if(!n.startsWith(i))throw g(Ae,`Path "${n}" expected to be starting with "${i}"`);n=n.slice(i.length)}return new be([n],0,s)}function Ps(s){const e=s.match(/#(.+)/);return e?e[1]:null}function Rs(s,e){if(ae()){const t=sessionStorage.getItem(s);if(t)try{const{index:n,history:i}=JSON.parse(t);return new be(i,n,e)}catch(n){console.error("Unable to restore hash navigator state.",n)}}return St(e)}function Ts(s,e){const t=Rs(s,e),n=()=>sessionStorage.setItem(s,JSON.stringify({index:t.index,history:t.history}));return t.on("change",n),n(),t}return a.BackButton=We,a.BasicNavigator=Et,a.BiometryManager=tt,a.BrowserNavigator=be,a.ClosingBehavior=nt,a.CloudStorage=at,a.ERR_INVALID_PATH_BASE=Ae,a.ERR_INVOKE_CUSTOM_METHOD_RESPONSE=Se,a.ERR_METHOD_PARAMETER_UNSUPPORTED=Ee,a.ERR_METHOD_UNSUPPORTED=ye,a.ERR_NAVIGATION_HISTORY_EMPTY=Te,a.ERR_NAVIGATION_INDEX_INVALID=Ce,a.ERR_NAVIGATION_ITEM_INVALID=Ct,a.ERR_PARSE=Y,a.ERR_SSR_INIT=At,a.ERR_TIMED_OUT=Pe,a.ERR_UNEXPECTED_TYPE=Re,a.ERR_UNKNOWN_ENV=ve,a.EventEmitter=R,a.HapticFeedback=ot,a.InitData=ct,a.Invoice=ht,a.MainButton=pt,a.MiniApp=lt,a.Popup=dt,a.QRScanner=_t,a.SDKError=k,a.SettingsButton=ft,a.SwipeBehavior=gt,a.ThemeParams=bt,a.Utils=wt,a.Viewport=mt,a.array=it,a.bindMiniAppCSSVars=fs,a.bindThemeParamsCSSVars=gs,a.bindViewportCSSVars=bs,a.boolean=E,a.captureSameReq=X,a.classNames=W,a.compareVersions=ke,a.createBrowserNavigatorFromLocation=St,a.createPostEvent=Le,a.createSafeURL=q,a.date=ie,a.getHash=Ps,a.getPathname=_e,a.initBackButton=zt,a.initBiometryManager=Ft,a.initClosingBehavior=Jt,a.initCloudStorage=Qt,a.initHapticFeedback=Xt,a.initInitData=Zt,a.initInvoice=ts,a.initMainButton=ss,a.initMiniApp=rs,a.initNavigator=Ts,a.initPopup=os,a.initQRScanner=cs,a.initSettingsButton=hs,a.initSwipeBehavior=ps,a.initThemeParams=us,a.initUtils=ds,a.initViewport=_s,a.initWeb=ws,a.invokeCustomMethod=I,a.isColorDark=te,a.isIframe=Q,a.isPageReload=ae,a.isRGB=H,a.isRGBShort=Ue,a.isSDKError=yt,a.isSDKErrorOfType=vs,a.isSSR=ms,a.isTMA=ys,a.json=w,a.mergeClassNames=Mt,a.mockTelegramEnv=Es,a.number=S,a.off=D,a.on=m,a.parseInitData=es,a.parseLaunchParams=x,a.parseThemeParams=he,a.postEvent=A,a.request=_,a.requestBiometryInfo=st,a.requestThemeParams=ls,a.requestViewport=pe,a.retrieveLaunchParams=Ze,a.rgb=xe,a.searchParams=G,a.serializeLaunchParams=Qe,a.serializeThemeParams=re,a.setCSSVar=v,a.setDebug=Rt,a.setTargetOrigin=Bt,a.string=u,a.subscribe=we,a.supports=P,a.targetOrigin=Me,a.toRGB=ee,a.unsubscribe=y,a.urlToPath=L,a.withTimeout=Z,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),a}({});
//# sourceMappingURL=index.iife.js.map
